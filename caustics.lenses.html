<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>caustics.lenses package &mdash; caustics v0.5.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="_static/caustics_favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=e663822d"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="caustics.light package" href="caustics.light.html" />
    <link rel="prev" title="caustics.data package" href="caustics.data.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            caustics
          </a>
              <div class="version">
                0.5
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">caustics</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="caustics.html">caustics package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="caustics.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="caustics.data.html">caustics.data package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">caustics.lenses package</a></li>
<li class="toctree-l4"><a class="reference internal" href="caustics.light.html">caustics.light package</a></li>
<li class="toctree-l4"><a class="reference internal" href="caustics.sims.html">caustics.sims package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="caustics.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="caustics.html#module-caustics.constants">caustics.constants module</a></li>
<li class="toctree-l3"><a class="reference internal" href="caustics.html#module-caustics.cosmology">caustics.cosmology module</a></li>
<li class="toctree-l3"><a class="reference internal" href="caustics.html#module-caustics.namespace_dict">caustics.namespace_dict module</a></li>
<li class="toctree-l3"><a class="reference internal" href="caustics.html#module-caustics.packed">caustics.packed module</a></li>
<li class="toctree-l3"><a class="reference internal" href="caustics.html#module-caustics.parameter">caustics.parameter module</a></li>
<li class="toctree-l3"><a class="reference internal" href="caustics.html#module-caustics.parametrized">caustics.parametrized module</a></li>
<li class="toctree-l3"><a class="reference internal" href="caustics.html#module-caustics.utils">caustics.utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="caustics.html#module-caustics">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">caustics</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">caustics</a></li>
          <li class="breadcrumb-item"><a href="caustics.html">caustics package</a></li>
      <li class="breadcrumb-item active">caustics.lenses package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/caustics.lenses.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="caustics-lenses-package">
<h1>caustics.lenses package<a class="headerlink" href="#caustics-lenses-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-caustics.lenses.base">
<span id="caustics-lenses-base-module"></span><h2>caustics.lenses.base module<a class="headerlink" href="#module-caustics.lenses.base" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="caustics.lenses.base.ThickLens">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">caustics.lenses.base.</span></span><span class="sig-name descname"><span class="pre">ThickLens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cosmology</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.cosmology.Cosmology" title="caustics.cosmology.Cosmology"><span class="pre">Cosmology</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/caustics/lenses/base.html#ThickLens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.base.ThickLens" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Lens</span></code></p>
<p>Base class for modeling gravitational lenses that cannot be treated using the thin lens approximation.
It is an abstract class and should be subclassed for different types of lens models.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.base.ThickLens.cosmology">
<span class="sig-name descname"><span class="pre">cosmology</span></span><a class="headerlink" href="#caustics.lenses.base.ThickLens.cosmology" title="Link to this definition"></a></dt>
<dd><p>An instance of a Cosmology class that describes the cosmological parameters of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="caustics.html#caustics.cosmology.Cosmology" title="caustics.cosmology.Cosmology">Cosmology</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.base.ThickLens.effective_convergence_curl">
<span class="sig-name descname"><span class="pre">effective_convergence_curl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/base.html#ThickLens.effective_convergence_curl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.base.ThickLens.effective_convergence_curl" title="Link to this definition"></a></dt>
<dd><p>Use the curl of the effective reduced deflection angle vector field to compute an effective convergence which derrives specifically from the curl of the deflection field. This field is purely a result of multiplane lensing and cannot occur in single plane lensing. See: <a class="reference external" href="https://arxiv.org/pdf/2006.07383.pdf">https://arxiv.org/pdf/2006.07383.pdf</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.base.ThickLens.effective_convergence_div">
<span class="sig-name descname"><span class="pre">effective_convergence_div</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/base.html#ThickLens.effective_convergence_div"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.base.ThickLens.effective_convergence_div" title="Link to this definition"></a></dt>
<dd><p>Using the divergence of the effective reduced delfection angle we can compute the divergence component of the effective convergence field. This field produces a single plane convergence field which reproduces as much of the deflection field as possible for a single plane. See: <a class="reference external" href="https://arxiv.org/pdf/2006.07383.pdf">https://arxiv.org/pdf/2006.07383.pdf</a> see also the <cite>effective_convergence_curl</cite> method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.base.ThickLens.effective_reduced_deflection_angle">
<span class="sig-name descname"><span class="pre">effective_reduced_deflection_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/caustics/lenses/base.html#ThickLens.effective_reduced_deflection_angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.base.ThickLens.effective_reduced_deflection_angle" title="Link to this definition"></a></dt>
<dd><p>ThickLens objects do not have a reduced deflection angle since the
distance D_ls is undefined. Instead we define an effective
reduced deflection angle by simply assuming the relation
$lpha =        heta - eta$ holds, where $lpha$ is the
effective reduced deflection angle, $   heta$ are the observed
angular coordinates, and $eta$ are the angular coordinates
to the source plane.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – Tensor of x coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – Tensor of y coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Tensor of source redshifts.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container for the lens model. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.base.ThickLens.jacobian_effective_deflection_angle">
<span class="sig-name descname"><span class="pre">jacobian_effective_deflection_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'autograd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixelscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/caustics/lenses/base.html#ThickLens.jacobian_effective_deflection_angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.base.ThickLens.jacobian_effective_deflection_angle" title="Link to this definition"></a></dt>
<dd><p>Return the jacobian of the effective reduced deflection angle vector field. This equates to a (2,2) matrix at each (x,y) point.</p>
<p>method: autograd or fft</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.base.ThickLens.physical_deflection_angle">
<span class="sig-name descname"><span class="pre">physical_deflection_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/caustics/lenses/base.html#ThickLens.physical_deflection_angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.base.ThickLens.physical_deflection_angle" title="Link to this definition"></a></dt>
<dd><p>Physical deflection angles are computed with respect to a lensing
plane. ThickLens objects have no unique definition of a lens
plane and so cannot compute a physical_deflection_angle</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – Tensor of x coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – Tensor of y coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Tensor of source redshifts.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container for the lens model. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of Tensors representing the x and y components of the deflection angle, respectively.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[Tensor, Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.base.ThickLens.raytrace">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">raytrace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/caustics/lenses/base.html#ThickLens.raytrace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.base.ThickLens.raytrace" title="Link to this definition"></a></dt>
<dd><p>Performs ray tracing by computing the angular position on the
source plance associated with a given input observed angular
coordinate x,y.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – Tensor of x coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – Tensor of y coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Tensor of source redshifts.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container for the lens model. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of Tensors representing the x and y coordinates of the ray-traced light rays, respectively.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[Tensor, Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.base.ThickLens.reduced_deflection_angle">
<span class="sig-name descname"><span class="pre">reduced_deflection_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/caustics/lenses/base.html#ThickLens.reduced_deflection_angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.base.ThickLens.reduced_deflection_angle" title="Link to this definition"></a></dt>
<dd><p>ThickLens objects do not have a reduced deflection angle since the distance D_ls is undefined</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – Tensor of x coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – Tensor of y coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Tensor of source redshifts.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container for the lens model. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.base.ThickLens.surface_density">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">surface_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/base.html#ThickLens.surface_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.base.ThickLens.surface_density" title="Link to this definition"></a></dt>
<dd><p>Computes the projected mass density at given coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – Tensor of x coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – Tensor of y coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Tensor of source redshifts.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container for the lens model. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The projected mass density at the given coordinates in units of solar masses per square Megaparsec.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.base.ThickLens.time_delay">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">time_delay</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/base.html#ThickLens.time_delay"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.base.ThickLens.time_delay" title="Link to this definition"></a></dt>
<dd><p>Computes the gravitational time delay at given coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – Tensor of x coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – Tensor of y coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Tensor ofsource redshifts.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container for the lens model. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The gravitational time delay at the given coordinates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="caustics.lenses.base.ThinLens">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">caustics.lenses.base.</span></span><span class="sig-name descname"><span class="pre">ThinLens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cosmology</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.cosmology.Cosmology" title="caustics.cosmology.Cosmology"><span class="pre">Cosmology</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/caustics/lenses/base.html#ThinLens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.base.ThinLens" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Lens</span></code></p>
<p>Base class for thin gravitational lenses.</p>
<p>This class provides an interface for thin gravitational lenses,
i.e., lenses that can be modeled using the thin lens
approximation.  The class provides methods to compute several
lensing quantities such as the deflection angle, convergence,
potential, surface mass density, and gravitational time delay.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – Name of the lens model.</p></li>
<li><p><strong>cosmology</strong> (<a class="reference internal" href="caustics.html#caustics.cosmology.Cosmology" title="caustics.cosmology.Cosmology"><em>Cosmology</em></a>) – Cosmology object that encapsulates cosmological parameters and distances.</p></li>
<li><p><strong>z_l</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em><em>, </em><em>optional</em>) – Redshift of the lens. Defaults to None.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.base.ThinLens.convergence">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">convergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/base.html#ThinLens.convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.base.ThinLens.convergence" title="Link to this definition"></a></dt>
<dd><p>Computes the convergence of the lens at given coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – Tensor of x coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – Tensor of y coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Tensor of source redshifts.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container for the lens model. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Convergence at the given coordinates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.base.ThinLens.jacobian_deflection_angle">
<span class="sig-name descname"><span class="pre">jacobian_deflection_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'autograd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixelscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/caustics/lenses/base.html#ThinLens.jacobian_deflection_angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.base.ThinLens.jacobian_deflection_angle" title="Link to this definition"></a></dt>
<dd><p>Return the jacobian of the deflection angle vector. This equates to a (2,2) matrix at each (x,y) point.</p>
<p>method: autograd or fft</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.base.ThinLens.physical_deflection_angle">
<span class="sig-name descname"><span class="pre">physical_deflection_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/caustics/lenses/base.html#ThinLens.physical_deflection_angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.base.ThinLens.physical_deflection_angle" title="Link to this definition"></a></dt>
<dd><p>Computes the physical deflection angle immediately after passing through this lens’s plane.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – Tensor of x coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – Tensor of y coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Tensor of source redshifts.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container for the lens model. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Physical deflection angle in x and y directions in arcseconds.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[Tensor, Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.base.ThinLens.potential">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">potential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/base.html#ThinLens.potential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.base.ThinLens.potential" title="Link to this definition"></a></dt>
<dd><p>Computes the gravitational lensing potential at given coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – Tensor of x coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – Tensor of y coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Tensor of source redshifts.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container for the lens model. Defaults to None.</p></li>
</ul>
</dd>
</dl>
<p>Returns: Tensor: Gravitational lensing potential at the given coordinates in arcsec^2.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.base.ThinLens.raytrace">
<span class="sig-name descname"><span class="pre">raytrace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/caustics/lenses/base.html#ThinLens.raytrace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.base.ThinLens.raytrace" title="Link to this definition"></a></dt>
<dd><p>Perform a ray-tracing operation by subtracting the deflection angles from the input coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – Tensor of x coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – Tensor of y coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Tensor of source redshifts.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container for the lens model. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Ray-traced coordinates in the x and y directions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[Tensor, Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.base.ThinLens.reduced_deflection_angle">
<span class="sig-name descname"><span class="pre">reduced_deflection_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/caustics/lenses/base.html#ThinLens.reduced_deflection_angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.base.ThinLens.reduced_deflection_angle" title="Link to this definition"></a></dt>
<dd><p>Computes the reduced deflection angle of the lens at given coordinates [arcsec].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – Tensor of x coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – Tensor of y coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Tensor of source redshifts.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container for the lens model. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Reduced deflection angle in x and y directions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[Tensor, Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.base.ThinLens.surface_density">
<span class="sig-name descname"><span class="pre">surface_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/base.html#ThinLens.surface_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.base.ThinLens.surface_density" title="Link to this definition"></a></dt>
<dd><p>Computes the surface mass density of the lens at given coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – Tensor of x coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – Tensor of y coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Tensor of source redshifts.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container for the lens model. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Surface mass density at the given coordinates in solar masses per Mpc^2.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.base.ThinLens.time_delay">
<span class="sig-name descname"><span class="pre">time_delay</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/caustics/lenses/base.html#ThinLens.time_delay"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.base.ThinLens.time_delay" title="Link to this definition"></a></dt>
<dd><p>Compute the gravitational time delay for light passing through the lens at given coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – Tensor of x coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – Tensor of y coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Tensor of source redshifts.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container for the lens model. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Time delay at the given coordinates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-caustics.lenses.epl">
<span id="caustics-lenses-epl-module"></span><h2>caustics.lenses.epl module<a class="headerlink" href="#module-caustics.lenses.epl" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="caustics.lenses.epl.EPL">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">caustics.lenses.epl.</span></span><span class="sig-name descname"><span class="pre">EPL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cosmology</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.cosmology.Cosmology" title="caustics.cosmology.Cosmology"><span class="pre">Cosmology</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">18</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/caustics/lenses/epl.html#EPL"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.epl.EPL" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#caustics.lenses.base.ThinLens" title="caustics.lenses.base.ThinLens"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThinLens</span></code></a></p>
<p>Elliptical power law (EPL, aka singular power-law ellipsoid) profile.</p>
<p>This class represents a thin gravitational lens model with an elliptical power law profile. The lensing equations are solved
iteratively using an approach based on Tessore et al. 2015.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.epl.EPL.n_iter">
<span class="sig-name descname"><span class="pre">n_iter</span></span><a class="headerlink" href="#caustics.lenses.epl.EPL.n_iter" title="Link to this definition"></a></dt>
<dd><p>Number of iterations for the iterative solver.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.epl.EPL.s">
<span class="sig-name descname"><span class="pre">s</span></span><a class="headerlink" href="#caustics.lenses.epl.EPL.s" title="Link to this definition"></a></dt>
<dd><p>Softening length for the elliptical power-law profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z_l</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>Tensor</em><em>, </em><em>float</em><em>]</em><em>]</em>) – This is the redshift of the lens. In the context of gravitational lensing, the lens is the galaxy or other mass distribution that is bending the light from a more distant source.</p></li>
<li><p><strong>y0</strong> (<em>x0 and</em>) – These are the coordinates of the lens center in the lens plane. The lens plane is the plane perpendicular to the line of sight in which the deflection of light by the lens is considered.</p></li>
<li><p><strong>q</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>Tensor</em><em>, </em><em>float</em><em>]</em><em>]</em>) – This is the axis ratio of the lens, i.e., the ratio of the minor axis to the major axis of the elliptical lens.</p></li>
<li><p><strong>phi</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>Tensor</em><em>, </em><em>float</em><em>]</em><em>]</em>) – This is the orientation of the lens on the sky, typically given as an angle measured counter-clockwise from some reference direction.</p></li>
<li><p><strong>b</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>Tensor</em><em>, </em><em>float</em><em>]</em><em>]</em>) – This is the scale length of the lens, which sets the overall scale of the lensing effect. In some contexts, this is referred to as the Einstein radius.</p></li>
<li><p><strong>t</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>Tensor</em><em>, </em><em>float</em><em>]</em><em>]</em>) – This is the power-law slope parameter of the lens model. In the context of the EPL model, t is equivalent to the gamma parameter minus one, where gamma is the power-law index of the radial mass distribution of the lens.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.epl.EPL.convergence">
<span class="sig-name descname"><span class="pre">convergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/caustics/lenses/epl.html#EPL.convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.epl.EPL.convergence" title="Link to this definition"></a></dt>
<dd><p>Compute the convergence of the lens, which describes the local density of the lens.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – X coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – Y coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Source redshifts.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container for the lens model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The convergence of the lens.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.epl.EPL.potential">
<span class="sig-name descname"><span class="pre">potential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/caustics/lenses/epl.html#EPL.potential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.epl.EPL.potential" title="Link to this definition"></a></dt>
<dd><p>Compute the lensing potential of the lens.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – X coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – Y coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Source redshifts.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container for the lens model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The lensing potential.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.epl.EPL.reduced_deflection_angle">
<span class="sig-name descname"><span class="pre">reduced_deflection_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/caustics/lenses/epl.html#EPL.reduced_deflection_angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.epl.EPL.reduced_deflection_angle" title="Link to this definition"></a></dt>
<dd><p>Compute the reduced deflection angles of the lens.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – X coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – Y coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Source redshifts.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container for the lens model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Reduced deflection angles in the x and y directions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[Tensor, Tensor]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-caustics.lenses.external_shear">
<span id="caustics-lenses-external-shear-module"></span><h2>caustics.lenses.external_shear module<a class="headerlink" href="#module-caustics.lenses.external_shear" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="caustics.lenses.external_shear.ExternalShear">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">caustics.lenses.external_shear.</span></span><span class="sig-name descname"><span class="pre">ExternalShear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cosmology</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.cosmology.Cosmology" title="caustics.cosmology.Cosmology"><span class="pre">Cosmology</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma_2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/caustics/lenses/external_shear.html#ExternalShear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.external_shear.ExternalShear" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#caustics.lenses.base.ThinLens" title="caustics.lenses.base.ThinLens"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThinLens</span></code></a></p>
<p>Represents an external shear effect in a gravitational lensing system.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.external_shear.ExternalShear.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#caustics.lenses.external_shear.ExternalShear.name" title="Link to this definition"></a></dt>
<dd><p>Identifier for the lens instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.external_shear.ExternalShear.cosmology">
<span class="sig-name descname"><span class="pre">cosmology</span></span><a class="headerlink" href="#caustics.lenses.external_shear.ExternalShear.cosmology" title="Link to this definition"></a></dt>
<dd><p>The cosmological model used for lensing calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="caustics.html#caustics.cosmology.Cosmology" title="caustics.cosmology.Cosmology">Cosmology</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.external_shear.ExternalShear.z_l">
<span class="sig-name descname"><span class="pre">z_l</span></span><a class="headerlink" href="#caustics.lenses.external_shear.ExternalShear.z_l" title="Link to this definition"></a></dt>
<dd><p>The redshift of the lens.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Union[Tensor, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">x0,</span> <span class="pre">y0</span></span></dt>
<dd><p>Coordinates of the shear center in the lens plane.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Union[Tensor, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">gamma_1,</span> <span class="pre">gamma_2</span></span></dt>
<dd><p>Shear components.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Union[Tensor, float]]</p>
</dd>
</dl>
</dd></dl>

<p>Note: The shear components gamma_1 and gamma_2 represent an external shear, a gravitational
distortion that can be caused by nearby structures outside of the main lens galaxy.</p>
<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.external_shear.ExternalShear.convergence">
<span class="sig-name descname"><span class="pre">convergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma_2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/external_shear.html#ExternalShear.convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.external_shear.ExternalShear.convergence" title="Link to this definition"></a></dt>
<dd><p>The convergence is undefined for an external shear.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – x-coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – y-coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Redshifts of the sources.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>NotImplementedError</strong> – This method is not implemented as the convergence is not defined</p></li>
<li><p><strong>for an external shear.</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.external_shear.ExternalShear.potential">
<span class="sig-name descname"><span class="pre">potential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma_2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/external_shear.html#ExternalShear.potential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.external_shear.ExternalShear.potential" title="Link to this definition"></a></dt>
<dd><p>Calculates the lensing potential.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – x-coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – y-coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Redshifts of the sources.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The lensing potential.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.external_shear.ExternalShear.reduced_deflection_angle">
<span class="sig-name descname"><span class="pre">reduced_deflection_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma_2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/caustics/lenses/external_shear.html#ExternalShear.reduced_deflection_angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.external_shear.ExternalShear.reduced_deflection_angle" title="Link to this definition"></a></dt>
<dd><p>Calculates the reduced deflection angle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – x-coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – y-coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Redshifts of the sources.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The reduced deflection angles in the x and y directions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[Tensor, Tensor]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-caustics.lenses.mass_sheet">
<span id="caustics-lenses-mass-sheet-module"></span><h2>caustics.lenses.mass_sheet module<a class="headerlink" href="#module-caustics.lenses.mass_sheet" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="caustics.lenses.mass_sheet.MassSheet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">caustics.lenses.mass_sheet.</span></span><span class="sig-name descname"><span class="pre">MassSheet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cosmology</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.cosmology.Cosmology" title="caustics.cosmology.Cosmology"><span class="pre">Cosmology</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_density</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/caustics/lenses/mass_sheet.html#MassSheet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.mass_sheet.MassSheet" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#caustics.lenses.base.ThinLens" title="caustics.lenses.base.ThinLens"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThinLens</span></code></a></p>
<p>Represents an external shear effect in a gravitational lensing system.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.mass_sheet.MassSheet.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#caustics.lenses.mass_sheet.MassSheet.name" title="Link to this definition"></a></dt>
<dd><p>Identifier for the lens instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.mass_sheet.MassSheet.cosmology">
<span class="sig-name descname"><span class="pre">cosmology</span></span><a class="headerlink" href="#caustics.lenses.mass_sheet.MassSheet.cosmology" title="Link to this definition"></a></dt>
<dd><p>The cosmological model used for lensing calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="caustics.html#caustics.cosmology.Cosmology" title="caustics.cosmology.Cosmology">Cosmology</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.mass_sheet.MassSheet.z_l">
<span class="sig-name descname"><span class="pre">z_l</span></span><a class="headerlink" href="#caustics.lenses.mass_sheet.MassSheet.z_l" title="Link to this definition"></a></dt>
<dd><p>The redshift of the lens.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Union[Tensor, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">x0,</span> <span class="pre">y0</span></span></dt>
<dd><p>Coordinates of the shear center in the lens plane.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Union[Tensor, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">gamma_1,</span> <span class="pre">gamma_2</span></span></dt>
<dd><p>Shear components.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Union[Tensor, float]]</p>
</dd>
</dl>
</dd></dl>

<p>Note: The shear components gamma_1 and gamma_2 represent an external shear, a gravitational
distortion that can be caused by nearby structures outside of the main lens galaxy.</p>
<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.mass_sheet.MassSheet.convergence">
<span class="sig-name descname"><span class="pre">convergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_density</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/caustics/lenses/mass_sheet.html#MassSheet.convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.mass_sheet.MassSheet.convergence" title="Link to this definition"></a></dt>
<dd><p>Computes the convergence of the lens at given coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – Tensor of x coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – Tensor of y coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Tensor of source redshifts.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container for the lens model. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Convergence at the given coordinates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.mass_sheet.MassSheet.potential">
<span class="sig-name descname"><span class="pre">potential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_density</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/caustics/lenses/mass_sheet.html#MassSheet.potential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.mass_sheet.MassSheet.potential" title="Link to this definition"></a></dt>
<dd><p>Computes the gravitational lensing potential at given coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – Tensor of x coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – Tensor of y coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Tensor of source redshifts.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container for the lens model. Defaults to None.</p></li>
</ul>
</dd>
</dl>
<p>Returns: Tensor: Gravitational lensing potential at the given coordinates in arcsec^2.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.mass_sheet.MassSheet.reduced_deflection_angle">
<span class="sig-name descname"><span class="pre">reduced_deflection_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_density</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/caustics/lenses/mass_sheet.html#MassSheet.reduced_deflection_angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.mass_sheet.MassSheet.reduced_deflection_angle" title="Link to this definition"></a></dt>
<dd><p>Calculates the reduced deflection angle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – x-coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – y-coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Redshifts of the sources.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The reduced deflection angles in the x and y directions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[Tensor, Tensor]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-caustics.lenses.multiplane">
<span id="caustics-lenses-multiplane-module"></span><h2>caustics.lenses.multiplane module<a class="headerlink" href="#module-caustics.lenses.multiplane" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="caustics.lenses.multiplane.Multiplane">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">caustics.lenses.multiplane.</span></span><span class="sig-name descname"><span class="pre">Multiplane</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cosmology</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.cosmology.Cosmology" title="caustics.cosmology.Cosmology"><span class="pre">Cosmology</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lenses</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#caustics.lenses.base.ThinLens" title="caustics.lenses.base.ThinLens"><span class="pre">ThinLens</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/caustics/lenses/multiplane.html#Multiplane"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.multiplane.Multiplane" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#caustics.lenses.base.ThickLens" title="caustics.lenses.base.ThickLens"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThickLens</span></code></a></p>
<p>Class for handling gravitational lensing with multiple lens planes.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.multiplane.Multiplane.lenses">
<span class="sig-name descname"><span class="pre">lenses</span></span><a class="headerlink" href="#caustics.lenses.multiplane.Multiplane.lenses" title="Link to this definition"></a></dt>
<dd><p>List of thin lenses.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[<a class="reference internal" href="#caustics.lenses.base.ThinLens" title="caustics.lenses.base.ThinLens">ThinLens</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – Name of the lens.</p></li>
<li><p><strong>cosmology</strong> (<a class="reference internal" href="caustics.html#caustics.cosmology.Cosmology" title="caustics.cosmology.Cosmology"><em>Cosmology</em></a>) – Cosmological parameters used for calculations.</p></li>
<li><p><strong>lenses</strong> (<em>list</em><em>[</em><a class="reference internal" href="#caustics.lenses.base.ThinLens" title="caustics.lenses.base.ThinLens"><em>ThinLens</em></a><em>]</em>) – List of thin lenses.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.multiplane.Multiplane.effective_reduced_deflection_angle">
<span class="sig-name descname"><span class="pre">effective_reduced_deflection_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/caustics/lenses/multiplane.html#Multiplane.effective_reduced_deflection_angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.multiplane.Multiplane.effective_reduced_deflection_angle" title="Link to this definition"></a></dt>
<dd><p>ThickLens objects do not have a reduced deflection angle since the
distance D_ls is undefined. Instead we define an effective
reduced deflection angle by simply assuming the relation
$lpha =        heta - eta$ holds, where $lpha$ is the
effective reduced deflection angle, $   heta$ are the observed
angular coordinates, and $eta$ are the angular coordinates
to the source plane.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – Tensor of x coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – Tensor of y coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Tensor of source redshifts.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container for the lens model. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.multiplane.Multiplane.get_z_ls">
<span class="sig-name descname"><span class="pre">get_z_ls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/caustics/lenses/multiplane.html#Multiplane.get_z_ls"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.multiplane.Multiplane.get_z_ls" title="Link to this definition"></a></dt>
<dd><p>Get the redshifts of each lens in the multiplane.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Redshifts of the lenses.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.multiplane.Multiplane.raytrace">
<span class="sig-name descname"><span class="pre">raytrace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/caustics/lenses/multiplane.html#Multiplane.raytrace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.multiplane.Multiplane.raytrace" title="Link to this definition"></a></dt>
<dd><dl>
<dt>Calculate the angular source positions corresponding to the</dt><dd><p>observer positions x,y. See Margarita et al. 2013 for the
formalism from the GLAMER -II code:
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2014MNRAS.445.1954P/abstract">https://ui.adsabs.harvard.edu/abs/2014MNRAS.445.1954P/abstract</a></p>
<p>The primary equation used here is equation 18. With a slight correction it reads:</p>
<div class="math notranslate nohighlight">
\[\]</div>
</dd>
</dl>
<p>ec{x}^{i+1} =
ec{x}^i + D_{i+1,i}left[
ec{ heta} - sum_{j=1}^{i}f{lpha}^j(
ec{x}^j)
ight]</p>
<blockquote>
<div><p>As an initialization we set the physical positions at the first lensing plane to be :math:<a href="#id1"><span class="problematic" id="id2">`</span></a></p>
</div></blockquote>
<p>ec{ heta}D_{1,0}` which is just propogation through regular space to the first plane. Note that :math:`
ec{lpha}` is a physical deflection angle. The equation above converts straightforwardly into a recursion formula:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\]</div>
</div></blockquote>
<p>ec{x}^{i+1} =
ec{x}^i + D_{i+1,i}
ec{       heta}^{i}</p>
<p>ec{  heta}^{i+1} =
ec{      heta}^{i} -  lpha^i(
ec{x}^{i+1})</p>
<blockquote>
<div><p>Here we set as initialization :math:<a href="#id3"><span class="problematic" id="id4">`</span></a></p>
</div></blockquote>
<p>ec{       heta}^0 = theta` the observation angular coordinates and :math:`
ec{x}^0 = 0` the initial physical coordinates (i.e. the observation rays come from a point at the observer). The indexing of :math:`
ec{x}^i` and :math:`
ec{  heta}^i` indicates the properties at the plane <span class="math notranslate nohighlight">\(i\)</span>, and 0 means the observer, 1 is the first lensing plane (infinitesimally after the plane since the deflection has been applied), and so on. Note that in the actual implementation we start at :math:`
ec{x}^1` and :math:`
ec{        heta}^0` and begin at the second step in the recursion formula.</p>
<blockquote>
<div><dl class="simple">
<dt>Args:</dt><dd><p>x (Tensor): angular x-coordinates from the observer perspective.
y (Tensor): angular y-coordinates from the observer perspective.
z_s (Tensor): Redshifts of the sources.
params (Packed, optional): Dynamic parameter container.</p>
</dd>
<dt>Returns:</dt><dd><p>tuple[Tensor, Tensor]: The reduced deflection angle.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.multiplane.Multiplane.raytrace_z1z2">
<span class="sig-name descname"><span class="pre">raytrace_z1z2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/caustics/lenses/multiplane.html#Multiplane.raytrace_z1z2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.multiplane.Multiplane.raytrace_z1z2" title="Link to this definition"></a></dt>
<dd><p>Method to do multiplane ray tracing from arbitrary start/end redshift.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.multiplane.Multiplane.surface_density">
<span class="sig-name descname"><span class="pre">surface_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/multiplane.html#Multiplane.surface_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.multiplane.Multiplane.surface_density" title="Link to this definition"></a></dt>
<dd><p>Calculate the projected mass density.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – x-coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – y-coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Redshifts of the sources.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Projected mass density [solMass / Mpc^2].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – This method is not yet implemented.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.multiplane.Multiplane.time_delay">
<span class="sig-name descname"><span class="pre">time_delay</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/multiplane.html#Multiplane.time_delay"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.multiplane.Multiplane.time_delay" title="Link to this definition"></a></dt>
<dd><p>Compute the time delay of light caused by the lensing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – x-coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – y-coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Redshifts of the sources.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Time delay caused by the lensing.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – This method is not yet implemented.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-caustics.lenses.nfw">
<span id="caustics-lenses-nfw-module"></span><h2>caustics.lenses.nfw module<a class="headerlink" href="#module-caustics.lenses.nfw" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="caustics.lenses.nfw.NFW">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">caustics.lenses.nfw.</span></span><span class="sig-name descname"><span class="pre">NFW</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cosmology</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.cosmology.Cosmology" title="caustics.cosmology.Cosmology"><span class="pre">Cosmology</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_case</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'batchable'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/caustics/lenses/nfw.html#NFW"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.nfw.NFW" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#caustics.lenses.base.ThinLens" title="caustics.lenses.base.ThinLens"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThinLens</span></code></a></p>
<p>NFW lens class. This class models a lens using the Navarro-Frenk-White (NFW) profile.
The NFW profile is a spatial density profile of dark matter halo that arises in
cosmological simulations.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.nfw.NFW.z_l">
<span class="sig-name descname"><span class="pre">z_l</span></span><a class="headerlink" href="#caustics.lenses.nfw.NFW.z_l" title="Link to this definition"></a></dt>
<dd><p>Redshift of the lens. Default is None.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.nfw.NFW.x0">
<span class="sig-name descname"><span class="pre">x0</span></span><a class="headerlink" href="#caustics.lenses.nfw.NFW.x0" title="Link to this definition"></a></dt>
<dd><p>x-coordinate of the lens center in the lens plane.
Default is None.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.nfw.NFW.y0">
<span class="sig-name descname"><span class="pre">y0</span></span><a class="headerlink" href="#caustics.lenses.nfw.NFW.y0" title="Link to this definition"></a></dt>
<dd><p>y-coordinate of the lens center in the lens plane.
Default is None.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.nfw.NFW.m">
<span class="sig-name descname"><span class="pre">m</span></span><a class="headerlink" href="#caustics.lenses.nfw.NFW.m" title="Link to this definition"></a></dt>
<dd><p>Mass of the lens. Default is None.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.nfw.NFW.c">
<span class="sig-name descname"><span class="pre">c</span></span><a class="headerlink" href="#caustics.lenses.nfw.NFW.c" title="Link to this definition"></a></dt>
<dd><p>Concentration parameter of the lens. Default is None.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.nfw.NFW.s">
<span class="sig-name descname"><span class="pre">s</span></span><a class="headerlink" href="#caustics.lenses.nfw.NFW.s" title="Link to this definition"></a></dt>
<dd><p>Softening parameter to avoid singularities at the center of the lens.
Default is 0.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.nfw.NFW.use_case">
<span class="sig-name descname"><span class="pre">use_case</span></span><a class="headerlink" href="#caustics.lenses.nfw.NFW.use_case" title="Link to this definition"></a></dt>
<dd><p>Due to an idyosyncratic behaviour of PyTorch, the NFW/TNFW profile
specifically cant be both batchable and differentiable. You may select which version
you wish to use by setting this parameter to one of: batchable, differentiable.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.nfw.NFW.get_scale_radius">
<span class="sig-name descname"><span class="pre">get_scale_radius</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/caustics/lenses/nfw.html#NFW.get_scale_radius"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.nfw.NFW.get_scale_radius" title="Link to this definition"></a></dt>
<dd><p>Returns the scale radius of the lens.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.nfw.NFW.get_scale_density">
<span class="sig-name descname"><span class="pre">get_scale_density</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/caustics/lenses/nfw.html#NFW.get_scale_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.nfw.NFW.get_scale_density" title="Link to this definition"></a></dt>
<dd><p>Returns the scale density of the lens.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.nfw.NFW.get_convergence_s">
<span class="sig-name descname"><span class="pre">get_convergence_s</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/caustics/lenses/nfw.html#NFW.get_convergence_s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.nfw.NFW.get_convergence_s" title="Link to this definition"></a></dt>
<dd><p>Returns the dimensionless surface mass density of the lens.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.nfw.NFW._f">
<span class="sig-name descname"><span class="pre">_f</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#caustics.lenses.nfw.NFW._f" title="Link to this definition"></a></dt>
<dd><p>Helper method for computing deflection angles.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.nfw.NFW._g">
<span class="sig-name descname"><span class="pre">_g</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#caustics.lenses.nfw.NFW._g" title="Link to this definition"></a></dt>
<dd><p>Helper method for computing lensing potential.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.nfw.NFW._h">
<span class="sig-name descname"><span class="pre">_h</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#caustics.lenses.nfw.NFW._h" title="Link to this definition"></a></dt>
<dd><p>Helper method for computing reduced deflection angles.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.nfw.NFW.deflection_angle_hat">
<span class="sig-name descname"><span class="pre">deflection_angle_hat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#caustics.lenses.nfw.NFW.deflection_angle_hat" title="Link to this definition"></a></dt>
<dd><p>Computes the reduced deflection angle.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.nfw.NFW.deflection_angle">
<span class="sig-name descname"><span class="pre">deflection_angle</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#caustics.lenses.nfw.NFW.deflection_angle" title="Link to this definition"></a></dt>
<dd><p>Computes the deflection angle.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.nfw.NFW.convergence">
<span class="sig-name descname"><span class="pre">convergence</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/caustics/lenses/nfw.html#NFW.convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.nfw.NFW.convergence" title="Link to this definition"></a></dt>
<dd><p>Computes the convergence (dimensionless surface mass density).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.nfw.NFW.potential">
<span class="sig-name descname"><span class="pre">potential</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/caustics/lenses/nfw.html#NFW.potential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.nfw.NFW.potential" title="Link to this definition"></a></dt>
<dd><p>Computes the lensing potential.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">convergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/nfw.html#NFW.convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd><p>Compute the convergence (dimensionless surface mass density).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – x-coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – y-coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Redshifts of the sources.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The convergence (dimensionless surface mass density).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">get_convergence_s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/nfw.html#NFW.get_convergence_s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id5" title="Link to this definition"></a></dt>
<dd><p>Calculate the dimensionless surface mass density of the lens.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z_l</strong> (<em>Tensor</em>) – Redshift of the lens.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Redshift of the source.</p></li>
<li><p><strong>m</strong> (<em>Tensor</em>) – Mass of the lens.</p></li>
<li><p><strong>c</strong> (<em>Tensor</em>) – Concentration parameter of the lens.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The dimensionless surface mass density of the lens.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id6">
<span class="sig-name descname"><span class="pre">get_scale_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/nfw.html#NFW.get_scale_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id6" title="Link to this definition"></a></dt>
<dd><p>Calculate the scale density of the lens.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z_l</strong> (<em>Tensor</em>) – Redshift of the lens.</p></li>
<li><p><strong>c</strong> (<em>Tensor</em>) – Concentration parameter of the lens.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The scale density of the lens in solar masses per Mpc cubed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id7">
<span class="sig-name descname"><span class="pre">get_scale_radius</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/nfw.html#NFW.get_scale_radius"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id7" title="Link to this definition"></a></dt>
<dd><p>Calculate the scale radius of the lens.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z_l</strong> (<em>Tensor</em>) – Redshift of the lens.</p></li>
<li><p><strong>m</strong> (<em>Tensor</em>) – Mass of the lens.</p></li>
<li><p><strong>c</strong> (<em>Tensor</em>) – Concentration parameter of the lens.</p></li>
<li><p><strong>x</strong> (<em>dict</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The scale radius of the lens in Mpc.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id8">
<span class="sig-name descname"><span class="pre">potential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/nfw.html#NFW.potential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id8" title="Link to this definition"></a></dt>
<dd><p>Compute the lensing potential.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – x-coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – y-coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Redshifts of the sources.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The lensing potential.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.nfw.NFW.reduced_deflection_angle">
<span class="sig-name descname"><span class="pre">reduced_deflection_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/caustics/lenses/nfw.html#NFW.reduced_deflection_angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.nfw.NFW.reduced_deflection_angle" title="Link to this definition"></a></dt>
<dd><p>Compute the reduced deflection angle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – x-coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – y-coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Redshifts of the sources.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The reduced deflection angles in the x and y directions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[Tensor, Tensor]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-caustics.lenses.pixelated_convergence">
<span id="caustics-lenses-pixelated-convergence-module"></span><h2>caustics.lenses.pixelated_convergence module<a class="headerlink" href="#module-caustics.lenses.pixelated_convergence" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="caustics.lenses.pixelated_convergence.PixelatedConvergence">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">caustics.lenses.pixelated_convergence.</span></span><span class="sig-name descname"><span class="pre">PixelatedConvergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pixelscale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_pix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmology</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.cosmology.Cosmology" title="caustics.cosmology.Cosmology"><span class="pre">Cosmology</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">tensor(0.)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">tensor(0.)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convergence_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convolution_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'fft'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_next_fast_len</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'zero'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/caustics/lenses/pixelated_convergence.html#PixelatedConvergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.pixelated_convergence.PixelatedConvergence" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#caustics.lenses.base.ThinLens" title="caustics.lenses.base.ThinLens"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThinLens</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.pixelated_convergence.PixelatedConvergence.convergence">
<span class="sig-name descname"><span class="pre">convergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convergence_map</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/pixelated_convergence.html#PixelatedConvergence.convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.pixelated_convergence.PixelatedConvergence.convergence" title="Link to this definition"></a></dt>
<dd><p>Compute the convergence at the specified positions. This method is not implemented.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – The x-coordinates of the positions to compute the convergence for.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – The y-coordinates of the positions to compute the convergence for.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – The source redshift.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – A dictionary containing additional parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The convergence at the specified positions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – This method is not implemented.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="caustics.lenses.pixelated_convergence.PixelatedConvergence.convolution_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">convolution_mode</span></span><a class="headerlink" href="#caustics.lenses.pixelated_convergence.PixelatedConvergence.convolution_mode" title="Link to this definition"></a></dt>
<dd><p>Get the convolution mode of the ConvergenceGrid object.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The convolution mode, either “fft” or “conv2d”.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.pixelated_convergence.PixelatedConvergence.potential">
<span class="sig-name descname"><span class="pre">potential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convergence_map</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/pixelated_convergence.html#PixelatedConvergence.potential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.pixelated_convergence.PixelatedConvergence.potential" title="Link to this definition"></a></dt>
<dd><p>Compute the lensing potential at the specified positions using the given convergence map.</p>
<p>Args:
x (Tensor): The x-coordinates of the positions to compute the lensing potential for.
y (Tensor): The y-coordinates of the positions to compute the lensing potential for.
z_s (Tensor): The source redshift.
params (Packed, optional): A dictionary containing additional parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The lensing potential at the specified positions.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.pixelated_convergence.PixelatedConvergence.reduced_deflection_angle">
<span class="sig-name descname"><span class="pre">reduced_deflection_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convergence_map</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/caustics/lenses/pixelated_convergence.html#PixelatedConvergence.reduced_deflection_angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.pixelated_convergence.PixelatedConvergence.reduced_deflection_angle" title="Link to this definition"></a></dt>
<dd><p>Compute the deflection angles at the specified positions using the given convergence map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – The x-coordinates of the positions to compute the deflection angles for.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – The y-coordinates of the positions to compute the deflection angles for.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – The source redshift.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – A dictionary containing additional parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The x and y components of the deflection angles at the specified positions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[Tensor, Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.pixelated_convergence.PixelatedConvergence.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dtype</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/caustics/lenses/pixelated_convergence.html#PixelatedConvergence.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.pixelated_convergence.PixelatedConvergence.to" title="Link to this definition"></a></dt>
<dd><p>Move the ConvergenceGrid object and all its tensors to the specified device and dtype.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> (<em>Optional</em><em>[</em><em>torch.device</em><em>]</em>) – The target device to move the tensors to.</p></li>
<li><p><strong>dtype</strong> (<em>Optional</em><em>[</em><em>torch.dtype</em><em>]</em>) – The target data type to cast the tensors to.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-caustics.lenses.point">
<span id="caustics-lenses-point-module"></span><h2>caustics.lenses.point module<a class="headerlink" href="#module-caustics.lenses.point" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="caustics.lenses.point.Point">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">caustics.lenses.point.</span></span><span class="sig-name descname"><span class="pre">Point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cosmology</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.cosmology.Cosmology" title="caustics.cosmology.Cosmology"><span class="pre">Cosmology</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th_ein</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/caustics/lenses/point.html#Point"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.point.Point" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#caustics.lenses.base.ThinLens" title="caustics.lenses.base.ThinLens"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThinLens</span></code></a></p>
<p>Class representing a point mass lens in strong gravitational lensing.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.point.Point.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#caustics.lenses.point.Point.name" title="Link to this definition"></a></dt>
<dd><p>The name of the point lens.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.point.Point.cosmology">
<span class="sig-name descname"><span class="pre">cosmology</span></span><a class="headerlink" href="#caustics.lenses.point.Point.cosmology" title="Link to this definition"></a></dt>
<dd><p>The cosmology used for calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="caustics.html#caustics.cosmology.Cosmology" title="caustics.cosmology.Cosmology">Cosmology</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.point.Point.z_l">
<span class="sig-name descname"><span class="pre">z_l</span></span><a class="headerlink" href="#caustics.lenses.point.Point.z_l" title="Link to this definition"></a></dt>
<dd><p>Redshift of the lens.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Union[Tensor, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.point.Point.x0">
<span class="sig-name descname"><span class="pre">x0</span></span><a class="headerlink" href="#caustics.lenses.point.Point.x0" title="Link to this definition"></a></dt>
<dd><p>x-coordinate of the center of the lens.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Union[Tensor, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.point.Point.y0">
<span class="sig-name descname"><span class="pre">y0</span></span><a class="headerlink" href="#caustics.lenses.point.Point.y0" title="Link to this definition"></a></dt>
<dd><p>y-coordinate of the center of the lens.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Union[Tensor, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.point.Point.th_ein">
<span class="sig-name descname"><span class="pre">th_ein</span></span><a class="headerlink" href="#caustics.lenses.point.Point.th_ein" title="Link to this definition"></a></dt>
<dd><p>Einstein radius of the lens.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Union[Tensor, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.point.Point.s">
<span class="sig-name descname"><span class="pre">s</span></span><a class="headerlink" href="#caustics.lenses.point.Point.s" title="Link to this definition"></a></dt>
<dd><p>Softening parameter to prevent numerical instabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.point.Point.convergence">
<span class="sig-name descname"><span class="pre">convergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th_ein</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/point.html#Point.convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.point.Point.convergence" title="Link to this definition"></a></dt>
<dd><p>Compute the convergence (dimensionless surface mass density).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – x-coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – y-coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Redshifts of the sources.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The convergence (dimensionless surface mass density).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.point.Point.potential">
<span class="sig-name descname"><span class="pre">potential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th_ein</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/point.html#Point.potential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.point.Point.potential" title="Link to this definition"></a></dt>
<dd><p>Compute the lensing potential.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – x-coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – y-coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Redshifts of the sources.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The lensing potential.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.point.Point.reduced_deflection_angle">
<span class="sig-name descname"><span class="pre">reduced_deflection_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th_ein</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/caustics/lenses/point.html#Point.reduced_deflection_angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.point.Point.reduced_deflection_angle" title="Link to this definition"></a></dt>
<dd><p>Compute the deflection angles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – x-coordinates in the lens plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – y-coordinates in the lens plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Redshifts of the sources.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The deflection angles in the x and y directions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[Tensor, Tensor]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-caustics.lenses.pseudo_jaffe">
<span id="caustics-lenses-pseudo-jaffe-module"></span><h2>caustics.lenses.pseudo_jaffe module<a class="headerlink" href="#module-caustics.lenses.pseudo_jaffe" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="caustics.lenses.pseudo_jaffe.PseudoJaffe">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">caustics.lenses.pseudo_jaffe.</span></span><span class="sig-name descname"><span class="pre">PseudoJaffe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cosmology</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.cosmology.Cosmology" title="caustics.cosmology.Cosmology"><span class="pre">Cosmology</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">core_radius</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_radius</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/caustics/lenses/pseudo_jaffe.html#PseudoJaffe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.pseudo_jaffe.PseudoJaffe" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#caustics.lenses.base.ThinLens" title="caustics.lenses.base.ThinLens"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThinLens</span></code></a></p>
<p>Class representing a Pseudo Jaffe lens in strong gravitational lensing,
based on <a class="reference external" href="https://arxiv.org/abs/0710.5636">Eliasdottir et al 2007</a> and
the <cite>lenstronomy</cite> source code.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.pseudo_jaffe.PseudoJaffe.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#caustics.lenses.pseudo_jaffe.PseudoJaffe.name" title="Link to this definition"></a></dt>
<dd><p>The name of the Pseudo Jaffe lens.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.pseudo_jaffe.PseudoJaffe.cosmology">
<span class="sig-name descname"><span class="pre">cosmology</span></span><a class="headerlink" href="#caustics.lenses.pseudo_jaffe.PseudoJaffe.cosmology" title="Link to this definition"></a></dt>
<dd><p>The cosmology used for calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="caustics.html#caustics.cosmology.Cosmology" title="caustics.cosmology.Cosmology">Cosmology</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.pseudo_jaffe.PseudoJaffe.z_l">
<span class="sig-name descname"><span class="pre">z_l</span></span><a class="headerlink" href="#caustics.lenses.pseudo_jaffe.PseudoJaffe.z_l" title="Link to this definition"></a></dt>
<dd><p>Redshift of the lens.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Union[Tensor, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.pseudo_jaffe.PseudoJaffe.x0">
<span class="sig-name descname"><span class="pre">x0</span></span><a class="headerlink" href="#caustics.lenses.pseudo_jaffe.PseudoJaffe.x0" title="Link to this definition"></a></dt>
<dd><p>x-coordinate of the center of the lens (arcsec).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Union[Tensor, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.pseudo_jaffe.PseudoJaffe.y0">
<span class="sig-name descname"><span class="pre">y0</span></span><a class="headerlink" href="#caustics.lenses.pseudo_jaffe.PseudoJaffe.y0" title="Link to this definition"></a></dt>
<dd><p>y-coordinate of the center of the lens (arcsec).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Union[Tensor, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.pseudo_jaffe.PseudoJaffe.mass">
<span class="sig-name descname"><span class="pre">mass</span></span><a class="headerlink" href="#caustics.lenses.pseudo_jaffe.PseudoJaffe.mass" title="Link to this definition"></a></dt>
<dd><p>Total mass of the lens (Msol).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Union[Tensor, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.pseudo_jaffe.PseudoJaffe.core_radius">
<span class="sig-name descname"><span class="pre">core_radius</span></span><a class="headerlink" href="#caustics.lenses.pseudo_jaffe.PseudoJaffe.core_radius" title="Link to this definition"></a></dt>
<dd><p>Core radius of the lens (arcsec).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Union[Tensor, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.pseudo_jaffe.PseudoJaffe.scale_radius">
<span class="sig-name descname"><span class="pre">scale_radius</span></span><a class="headerlink" href="#caustics.lenses.pseudo_jaffe.PseudoJaffe.scale_radius" title="Link to this definition"></a></dt>
<dd><p>Scaling radius of the lens (arcsec).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Union[Tensor, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.pseudo_jaffe.PseudoJaffe.s">
<span class="sig-name descname"><span class="pre">s</span></span><a class="headerlink" href="#caustics.lenses.pseudo_jaffe.PseudoJaffe.s" title="Link to this definition"></a></dt>
<dd><p>Softening parameter to prevent numerical instabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.pseudo_jaffe.PseudoJaffe.central_convergence">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">central_convergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">core_radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">critical_surface_density</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/caustics/lenses/pseudo_jaffe.html#PseudoJaffe.central_convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.pseudo_jaffe.PseudoJaffe.central_convergence" title="Link to this definition"></a></dt>
<dd><p>Compute the central convergence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z_l</strong> (<em>Tensor</em>) – Lens redshift.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Source redshift.</p></li>
<li><p><strong>rho_0</strong> (<em>Tensor</em>) – Central mass density.</p></li>
<li><p><strong>core_radius</strong> (<em>Tensor</em>) – Core radius of the lens (must be in Mpc).</p></li>
<li><p><strong>scale_radius</strong> (<em>Tensor</em>) – Scaling radius of the lens (must be in Mpc).</p></li>
<li><p><strong>cosmology</strong> (<a class="reference internal" href="caustics.html#caustics.cosmology.Cosmology" title="caustics.cosmology.Cosmology"><em>Cosmology</em></a>) – The cosmology used for calculations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The central convergence.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.pseudo_jaffe.PseudoJaffe.convergence">
<span class="sig-name descname"><span class="pre">convergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">core_radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_radius</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/pseudo_jaffe.html#PseudoJaffe.convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.pseudo_jaffe.PseudoJaffe.convergence" title="Link to this definition"></a></dt>
<dd><p>Calculate the projected mass density, based on equation A6.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – x-coordinate of the lens.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – y-coordinate of the lens.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Source redshift.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The projected mass density.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.pseudo_jaffe.PseudoJaffe.get_convergence_0">
<span class="sig-name descname"><span class="pre">get_convergence_0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">core_radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_radius</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/caustics/lenses/pseudo_jaffe.html#PseudoJaffe.get_convergence_0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.pseudo_jaffe.PseudoJaffe.get_convergence_0" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.pseudo_jaffe.PseudoJaffe.mass_enclosed_2d">
<span class="sig-name descname"><span class="pre">mass_enclosed_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">core_radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_radius</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/caustics/lenses/pseudo_jaffe.html#PseudoJaffe.mass_enclosed_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.pseudo_jaffe.PseudoJaffe.mass_enclosed_2d" title="Link to this definition"></a></dt>
<dd><p>Calculate the mass enclosed within a two-dimensional radius.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<em>Tensor</em>) – Radius at which to calculate enclosed mass (arcsec).</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Source redshift.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The mass enclosed within the given radius.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.pseudo_jaffe.PseudoJaffe.potential">
<span class="sig-name descname"><span class="pre">potential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">core_radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_radius</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/pseudo_jaffe.html#PseudoJaffe.potential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.pseudo_jaffe.PseudoJaffe.potential" title="Link to this definition"></a></dt>
<dd><p>Compute the lensing potential. This calculation is based on equation A18.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – x-coordinate of the lens.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – y-coordinate of the lens.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Source redshift.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The lensing potential.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.pseudo_jaffe.PseudoJaffe.reduced_deflection_angle">
<span class="sig-name descname"><span class="pre">reduced_deflection_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">core_radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_radius</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/caustics/lenses/pseudo_jaffe.html#PseudoJaffe.reduced_deflection_angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.pseudo_jaffe.PseudoJaffe.reduced_deflection_angle" title="Link to this definition"></a></dt>
<dd><p>Calculate the deflection angle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – x-coordinate of the lens.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – y-coordinate of the lens.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – Source redshift.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The deflection angle in the x and y directions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[Tensor, Tensor]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-caustics.lenses.sie">
<span id="caustics-lenses-sie-module"></span><h2>caustics.lenses.sie module<a class="headerlink" href="#module-caustics.lenses.sie" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="caustics.lenses.sie.SIE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">caustics.lenses.sie.</span></span><span class="sig-name descname"><span class="pre">SIE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cosmology</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.cosmology.Cosmology" title="caustics.cosmology.Cosmology"><span class="pre">Cosmology</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/caustics/lenses/sie.html#SIE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.sie.SIE" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#caustics.lenses.base.ThinLens" title="caustics.lenses.base.ThinLens"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThinLens</span></code></a></p>
<p>A class representing a Singular Isothermal Ellipsoid (SIE) strong gravitational lens model.
This model is based on Keeton 2001, which can be found at <a class="reference external" href="https://arxiv.org/abs/astro-ph/0102341">https://arxiv.org/abs/astro-ph/0102341</a>.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.sie.SIE.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#caustics.lenses.sie.SIE.name" title="Link to this definition"></a></dt>
<dd><p>The name of the lens.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.sie.SIE.cosmology">
<span class="sig-name descname"><span class="pre">cosmology</span></span><a class="headerlink" href="#caustics.lenses.sie.SIE.cosmology" title="Link to this definition"></a></dt>
<dd><p>An instance of the Cosmology class.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="caustics.html#caustics.cosmology.Cosmology" title="caustics.cosmology.Cosmology">Cosmology</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.sie.SIE.z_l">
<span class="sig-name descname"><span class="pre">z_l</span></span><a class="headerlink" href="#caustics.lenses.sie.SIE.z_l" title="Link to this definition"></a></dt>
<dd><p>The redshift of the lens.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Union[Tensor, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.sie.SIE.x0">
<span class="sig-name descname"><span class="pre">x0</span></span><a class="headerlink" href="#caustics.lenses.sie.SIE.x0" title="Link to this definition"></a></dt>
<dd><p>The x-coordinate of the lens center.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Union[Tensor, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.sie.SIE.y0">
<span class="sig-name descname"><span class="pre">y0</span></span><a class="headerlink" href="#caustics.lenses.sie.SIE.y0" title="Link to this definition"></a></dt>
<dd><p>The y-coordinate of the lens center.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Union[Tensor, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.sie.SIE.q">
<span class="sig-name descname"><span class="pre">q</span></span><a class="headerlink" href="#caustics.lenses.sie.SIE.q" title="Link to this definition"></a></dt>
<dd><p>The axis ratio of the lens.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Union[Tensor, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.sie.SIE.phi">
<span class="sig-name descname"><span class="pre">phi</span></span><a class="headerlink" href="#caustics.lenses.sie.SIE.phi" title="Link to this definition"></a></dt>
<dd><p>The orientation angle of the lens (position angle).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Union[Tensor, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.sie.SIE.b">
<span class="sig-name descname"><span class="pre">b</span></span><a class="headerlink" href="#caustics.lenses.sie.SIE.b" title="Link to this definition"></a></dt>
<dd><p>The Einstein radius of the lens.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Union[Tensor, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.sie.SIE.s">
<span class="sig-name descname"><span class="pre">s</span></span><a class="headerlink" href="#caustics.lenses.sie.SIE.s" title="Link to this definition"></a></dt>
<dd><p>The core radius of the lens (defaults to 0.0).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.sie.SIE.convergence">
<span class="sig-name descname"><span class="pre">convergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/sie.html#SIE.convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.sie.SIE.convergence" title="Link to this definition"></a></dt>
<dd><p>Calculate the projected mass density.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – The x-coordinate of the lens.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – The y-coordinate of the lens.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – The source redshift.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The projected mass.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.sie.SIE.potential">
<span class="sig-name descname"><span class="pre">potential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/sie.html#SIE.potential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.sie.SIE.potential" title="Link to this definition"></a></dt>
<dd><p>Compute the lensing potential.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – The x-coordinate of the lens.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – The y-coordinate of the lens.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – The source redshift.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The lensing potential.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.sie.SIE.reduced_deflection_angle">
<span class="sig-name descname"><span class="pre">reduced_deflection_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/caustics/lenses/sie.html#SIE.reduced_deflection_angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.sie.SIE.reduced_deflection_angle" title="Link to this definition"></a></dt>
<dd><p>Calculate the physical deflection angle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – The x-coordinate of the lens.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – The y-coordinate of the lens.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – The source redshift.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The deflection angle in the x and y directions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[Tensor, Tensor]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-caustics.lenses.singleplane">
<span id="caustics-lenses-singleplane-module"></span><h2>caustics.lenses.singleplane module<a class="headerlink" href="#module-caustics.lenses.singleplane" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="caustics.lenses.singleplane.SinglePlane">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">caustics.lenses.singleplane.</span></span><span class="sig-name descname"><span class="pre">SinglePlane</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cosmology</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.cosmology.Cosmology" title="caustics.cosmology.Cosmology"><span class="pre">Cosmology</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lenses</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#caustics.lenses.base.ThinLens" title="caustics.lenses.base.ThinLens"><span class="pre">ThinLens</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/caustics/lenses/singleplane.html#SinglePlane"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.singleplane.SinglePlane" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#caustics.lenses.base.ThinLens" title="caustics.lenses.base.ThinLens"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThinLens</span></code></a></p>
<p>A class for combining multiple thin lenses into a single lensing plane.
This model inherits from the base <cite>ThinLens</cite> class.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.singleplane.SinglePlane.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#caustics.lenses.singleplane.SinglePlane.name" title="Link to this definition"></a></dt>
<dd><p>The name of the single plane lens.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.singleplane.SinglePlane.cosmology">
<span class="sig-name descname"><span class="pre">cosmology</span></span><a class="headerlink" href="#caustics.lenses.singleplane.SinglePlane.cosmology" title="Link to this definition"></a></dt>
<dd><p>An instance of the Cosmology class.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="caustics.html#caustics.cosmology.Cosmology" title="caustics.cosmology.Cosmology">Cosmology</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.singleplane.SinglePlane.lenses">
<span class="sig-name descname"><span class="pre">lenses</span></span><a class="headerlink" href="#caustics.lenses.singleplane.SinglePlane.lenses" title="Link to this definition"></a></dt>
<dd><p>A list of ThinLens objects that are being combined into a single lensing plane.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#caustics.lenses.base.ThinLens" title="caustics.lenses.base.ThinLens">ThinLens</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.singleplane.SinglePlane.convergence">
<span class="sig-name descname"><span class="pre">convergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/singleplane.html#SinglePlane.convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.singleplane.SinglePlane.convergence" title="Link to this definition"></a></dt>
<dd><p>Calculate the total projected mass density by summing the mass densities of all individual lenses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – The x-coordinate of the lens.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – The y-coordinate of the lens.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – The source redshift.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total projected mass density.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.singleplane.SinglePlane.potential">
<span class="sig-name descname"><span class="pre">potential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/singleplane.html#SinglePlane.potential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.singleplane.SinglePlane.potential" title="Link to this definition"></a></dt>
<dd><p>Compute the total lensing potential by summing the lensing potentials of all individual lenses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – The x-coordinate of the lens.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – The y-coordinate of the lens.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – The source redshift.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total lensing potential.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.singleplane.SinglePlane.reduced_deflection_angle">
<span class="sig-name descname"><span class="pre">reduced_deflection_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/caustics/lenses/singleplane.html#SinglePlane.reduced_deflection_angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.singleplane.SinglePlane.reduced_deflection_angle" title="Link to this definition"></a></dt>
<dd><p>Calculate the total deflection angle by summing the deflection angles of all individual lenses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – The x-coordinate of the lens.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – The y-coordinate of the lens.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – The source redshift.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The total deflection angle in the x and y directions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[Tensor, Tensor]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-caustics.lenses.sis">
<span id="caustics-lenses-sis-module"></span><h2>caustics.lenses.sis module<a class="headerlink" href="#module-caustics.lenses.sis" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="caustics.lenses.sis.SIS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">caustics.lenses.sis.</span></span><span class="sig-name descname"><span class="pre">SIS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cosmology</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.cosmology.Cosmology" title="caustics.cosmology.Cosmology"><span class="pre">Cosmology</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th_ein</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/caustics/lenses/sis.html#SIS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.sis.SIS" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#caustics.lenses.base.ThinLens" title="caustics.lenses.base.ThinLens"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThinLens</span></code></a></p>
<p>A class representing the Singular Isothermal Sphere (SIS) model.
This model inherits from the base <cite>ThinLens</cite> class.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.sis.SIS.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#caustics.lenses.sis.SIS.name" title="Link to this definition"></a></dt>
<dd><p>The name of the SIS lens.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.sis.SIS.cosmology">
<span class="sig-name descname"><span class="pre">cosmology</span></span><a class="headerlink" href="#caustics.lenses.sis.SIS.cosmology" title="Link to this definition"></a></dt>
<dd><p>An instance of the Cosmology class.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="caustics.html#caustics.cosmology.Cosmology" title="caustics.cosmology.Cosmology">Cosmology</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.sis.SIS.z_l">
<span class="sig-name descname"><span class="pre">z_l</span></span><a class="headerlink" href="#caustics.lenses.sis.SIS.z_l" title="Link to this definition"></a></dt>
<dd><p>The lens redshift.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Union[Tensor, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.sis.SIS.x0">
<span class="sig-name descname"><span class="pre">x0</span></span><a class="headerlink" href="#caustics.lenses.sis.SIS.x0" title="Link to this definition"></a></dt>
<dd><p>The x-coordinate of the lens center.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Union[Tensor, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.sis.SIS.y0">
<span class="sig-name descname"><span class="pre">y0</span></span><a class="headerlink" href="#caustics.lenses.sis.SIS.y0" title="Link to this definition"></a></dt>
<dd><p>The y-coordinate of the lens center.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Union[Tensor, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.sis.SIS.th_ein">
<span class="sig-name descname"><span class="pre">th_ein</span></span><a class="headerlink" href="#caustics.lenses.sis.SIS.th_ein" title="Link to this definition"></a></dt>
<dd><p>The Einstein radius of the lens.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Union[Tensor, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="caustics.lenses.sis.SIS.s">
<span class="sig-name descname"><span class="pre">s</span></span><a class="headerlink" href="#caustics.lenses.sis.SIS.s" title="Link to this definition"></a></dt>
<dd><p>A smoothing factor, default is 0.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.sis.SIS.convergence">
<span class="sig-name descname"><span class="pre">convergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th_ein</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/sis.html#SIS.convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.sis.SIS.convergence" title="Link to this definition"></a></dt>
<dd><p>Calculate the projected mass density of the SIS lens.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – The x-coordinate of the lens.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – The y-coordinate of the lens.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – The source redshift.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The projected mass density.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.sis.SIS.potential">
<span class="sig-name descname"><span class="pre">potential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th_ein</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/sis.html#SIS.potential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.sis.SIS.potential" title="Link to this definition"></a></dt>
<dd><p>Compute the lensing potential of the SIS lens.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – The x-coordinate of the lens.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – The y-coordinate of the lens.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – The source redshift.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The lensing potential.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.sis.SIS.reduced_deflection_angle">
<span class="sig-name descname"><span class="pre">reduced_deflection_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th_ein</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/caustics/lenses/sis.html#SIS.reduced_deflection_angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.sis.SIS.reduced_deflection_angle" title="Link to this definition"></a></dt>
<dd><p>Calculate the deflection angle of the SIS lens.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Tensor</em>) – The x-coordinate of the lens.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – The y-coordinate of the lens.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – The source redshift.</p></li>
<li><p><strong>params</strong> (<a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><em>Packed</em></a><em>, </em><em>optional</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The deflection angle in the x and y directions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[Tensor, Tensor]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-caustics.lenses.tnfw">
<span id="caustics-lenses-tnfw-module"></span><h2>caustics.lenses.tnfw module<a class="headerlink" href="#module-caustics.lenses.tnfw" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="caustics.lenses.tnfw.TNFW">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">caustics.lenses.tnfw.</span></span><span class="sig-name descname"><span class="pre">TNFW</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cosmology</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.cosmology.Cosmology" title="caustics.cosmology.Cosmology"><span class="pre">Cosmology</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_radius</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpret_m_total_mass</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_case</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'batchable'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/caustics/lenses/tnfw.html#TNFW"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.tnfw.TNFW" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#caustics.lenses.base.ThinLens" title="caustics.lenses.base.ThinLens"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThinLens</span></code></a></p>
<p>Truncated Navaro-Frenk-White profile</p>
<p>TNFW lens class. This class models a lens using the truncated
Navarro-Frenk-White (NFW) profile.  The NFW profile is a spatial
density profile of dark matter halo that arises in cosmological
simulations. It is truncated with an extra scaling term which
smoothly reduces the density such that it does not diverge to
infinity. This is based off the paper by Baltz et al. 2009:</p>
<p><a class="reference external" href="https://arxiv.org/abs/0705.0682">https://arxiv.org/abs/0705.0682</a></p>
<p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2009JCAP...01..015B/abstract">https://ui.adsabs.harvard.edu/abs/2009JCAP…01..015B/abstract</a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The mass <cite>m</cite> in the TNFW profile corresponds to the total mass
of the lens. This is different from the NFW profile where the
mass <cite>m</cite> parameter corresponds to the mass within R200. If you
prefer the “mass within R200” version you can set:
<cite>interpret_m_total_mass = False</cite> on initialization of the
object. However, the mass within R200 will be computed for an
NFW profile, not a TNFW profile. This is in line with how
lenstronomy inteprets the mass parameter.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – Name of the lens instance.</p></li>
<li><p><strong>cosmology</strong> (<a class="reference internal" href="caustics.html#caustics.cosmology.Cosmology" title="caustics.cosmology.Cosmology"><em>Cosmology</em></a>) – An instance of the Cosmology class which contains
information about the cosmological model and parameters.</p></li>
<li><p><strong>z_l</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Redshift of the lens.</p></li>
<li><p><strong>x0</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Center of lens position on x-axis (arcsec).</p></li>
<li><p><strong>y0</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Center of lens position on y-axis (arcsec).</p></li>
<li><p><strong>mass</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Mass of the lens (Msol).</p></li>
<li><p><strong>scale_radius</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Scale radius of the TNFW lens (arcsec).</p></li>
<li><p><strong>tau</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Truncation scale. Ratio of truncation radius to scale radius (rt/rs).</p></li>
<li><p><strong>s</strong> (<em>float</em>) – Softening parameter to avoid singularities at the center of the lens.
Default is 0.0.</p></li>
<li><p><strong>interpret_m_total_mass</strong> (<em>bool</em>) – Indicates how to interpret the mass variable “m”. If true
the mass is intepreted as the total mass of the halo (good because it makes sense). If
false it is intepreted as what the mass would have been within R200 of a an NFW that
isn’t truncated (good because it is easily compared with an NFW).</p></li>
<li><p><strong>use_case</strong> (<em>str</em>) – Due to an idyosyncratic behaviour of PyTorch, the NFW/TNFW profile
specifically cant be both batchable and differentiable. You may select which version
you wish to use by setting this parameter to one of: batchable, differentiable.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.tnfw.TNFW.convergence">
<span class="sig-name descname"><span class="pre">convergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/tnfw.html#TNFW.convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.tnfw.TNFW.convergence" title="Link to this definition"></a></dt>
<dd><p>TNFW convergence as given in Baltz et al. 2009. This is unitless since it is Sigma(x) / Sigma_crit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z_l</strong> (<em>Tensor</em>) – Redshift of the lens.</p></li>
<li><p><strong>x0</strong> (<em>Tensor</em>) – Center of lens position on x-axis (arcsec).</p></li>
<li><p><strong>y0</strong> (<em>Tensor</em>) – Center of lens position on y-axis (arcsec).</p></li>
<li><p><strong>mass</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Mass of the lens (Msol).</p></li>
<li><p><strong>scale_radius</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Scale radius of the TNFW lens (arcsec).</p></li>
<li><p><strong>tau</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Truncation scale. Ratio of truncation radius to scale radius (rt/rs).</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>unitless convergence at requested position</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.tnfw.TNFW.get_M0">
<span class="sig-name descname"><span class="pre">get_M0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/tnfw.html#TNFW.get_M0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.tnfw.TNFW.get_M0" title="Link to this definition"></a></dt>
<dd><p>Calculate the reference mass. This is an abstract reference mass used internally in the equations from Baltz et al. 2009.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z_l</strong> (<em>Tensor</em>) – Redshift of the lens.</p></li>
<li><p><strong>x0</strong> (<em>Tensor</em>) – Center of lens position on x-axis (arcsec).</p></li>
<li><p><strong>y0</strong> (<em>Tensor</em>) – Center of lens position on y-axis (arcsec).</p></li>
<li><p><strong>mass</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Mass of the lens (Msol).</p></li>
<li><p><strong>scale_radius</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Scale radius of the TNFW lens (arcsec).</p></li>
<li><p><strong>tau</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Truncation scale. Ratio of truncation radius to scale radius (rt/rs).</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The reference mass of the lens in Msol.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.tnfw.TNFW.get_concentration">
<span class="sig-name descname"><span class="pre">get_concentration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/tnfw.html#TNFW.get_concentration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.tnfw.TNFW.get_concentration" title="Link to this definition"></a></dt>
<dd><p>Calculate the scale radius of the lens. This is the same formula used for the classic NFW profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z_l</strong> (<em>Tensor</em>) – Redshift of the lens.</p></li>
<li><p><strong>x0</strong> (<em>Tensor</em>) – Center of lens position on x-axis (arcsec).</p></li>
<li><p><strong>y0</strong> (<em>Tensor</em>) – Center of lens position on y-axis (arcsec).</p></li>
<li><p><strong>mass</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Mass of the lens (Msol).</p></li>
<li><p><strong>scale_radius</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Scale radius of the TNFW lens (arcsec).</p></li>
<li><p><strong>tau</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Truncation scale. Ratio of truncation radius to scale radius (rt/rs).</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The scale radius of the lens in Mpc.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.tnfw.TNFW.get_scale_density">
<span class="sig-name descname"><span class="pre">get_scale_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/tnfw.html#TNFW.get_scale_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.tnfw.TNFW.get_scale_density" title="Link to this definition"></a></dt>
<dd><p>Calculate the scale density of the lens.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z_l</strong> (<em>Tensor</em>) – Redshift of the lens.</p></li>
<li><p><strong>x0</strong> (<em>Tensor</em>) – Center of lens position on x-axis (arcsec).</p></li>
<li><p><strong>y0</strong> (<em>Tensor</em>) – Center of lens position on y-axis (arcsec).</p></li>
<li><p><strong>mass</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Mass of the lens (Msol).</p></li>
<li><p><strong>scale_radius</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Scale radius of the TNFW lens (arcsec).</p></li>
<li><p><strong>tau</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Truncation scale. Ratio of truncation radius to scale radius (rt/rs).</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The scale density of the lens in solar masses per Mpc cubed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.tnfw.TNFW.get_truncation_radius">
<span class="sig-name descname"><span class="pre">get_truncation_radius</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/tnfw.html#TNFW.get_truncation_radius"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.tnfw.TNFW.get_truncation_radius" title="Link to this definition"></a></dt>
<dd><p>Calculate the truncation radius of the TNFW lens.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z_l</strong> (<em>Tensor</em>) – Redshift of the lens.</p></li>
<li><p><strong>x0</strong> (<em>Tensor</em>) – Center of lens position on x-axis (arcsec).</p></li>
<li><p><strong>y0</strong> (<em>Tensor</em>) – Center of lens position on y-axis (arcsec).</p></li>
<li><p><strong>mass</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Mass of the lens (Msol).</p></li>
<li><p><strong>scale_radius</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Scale radius of the TNFW lens (arcsec).</p></li>
<li><p><strong>tau</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Truncation scale. Ratio of truncation radius to scale radius (rt/rs).</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The truncation radius of the lens in arcsec.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.tnfw.TNFW.mass_enclosed_2d">
<span class="sig-name descname"><span class="pre">mass_enclosed_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/tnfw.html#TNFW.mass_enclosed_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.tnfw.TNFW.mass_enclosed_2d" title="Link to this definition"></a></dt>
<dd><p>Total projected mass (Msol) within a radius r (arcsec).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z_l</strong> (<em>Tensor</em>) – Redshift of the lens.</p></li>
<li><p><strong>x0</strong> (<em>Tensor</em>) – Center of lens position on x-axis (arcsec).</p></li>
<li><p><strong>y0</strong> (<em>Tensor</em>) – Center of lens position on y-axis (arcsec).</p></li>
<li><p><strong>mass</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Mass of the lens (Msol).</p></li>
<li><p><strong>scale_radius</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Scale radius of the TNFW lens (arcsec).</p></li>
<li><p><strong>tau</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Truncation scale. Ratio of truncation radius to scale radius (rt/rs).</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Integrated mass projected in infinite cylinder within radius r.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.tnfw.TNFW.physical_deflection_angle">
<span class="sig-name descname"><span class="pre">physical_deflection_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/caustics/lenses/tnfw.html#TNFW.physical_deflection_angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.tnfw.TNFW.physical_deflection_angle" title="Link to this definition"></a></dt>
<dd><p>Compute the physical deflection angle (arcsec) for this lens at
the requested position. Note that the NFW/TNFW profile is more
naturally represented as a physical deflection angle, this is
easily internally converted to a reduced deflection angle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z_l</strong> (<em>Tensor</em>) – Redshift of the lens.</p></li>
<li><p><strong>x0</strong> (<em>Tensor</em>) – Center of lens position on x-axis (arcsec).</p></li>
<li><p><strong>y0</strong> (<em>Tensor</em>) – Center of lens position on y-axis (arcsec).</p></li>
<li><p><strong>mass</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Mass of the lens (Msol).</p></li>
<li><p><strong>scale_radius</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Scale radius of the TNFW lens (arcsec).</p></li>
<li><p><strong>tau</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Truncation scale. Ratio of truncation radius to scale radius (rt/rs).</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The physical deflection angles in the x and y directions (arcsec).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[Tensor, Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="caustics.lenses.tnfw.TNFW.potential">
<span class="sig-name descname"><span class="pre">potential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="caustics.html#caustics.packed.Packed" title="caustics.packed.Packed"><span class="pre">Packed</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/tnfw.html#TNFW.potential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.tnfw.TNFW.potential" title="Link to this definition"></a></dt>
<dd><p>Compute the lensing potential. Note that this is not a unitless potential! This is the potential as given in Baltz et al. 2009.</p>
<p>TODO: convert to dimensionless potential.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z_l</strong> (<em>Tensor</em>) – Redshift of the lens.</p></li>
<li><p><strong>x0</strong> (<em>Tensor</em>) – Center of lens position on x-axis (arcsec).</p></li>
<li><p><strong>y0</strong> (<em>Tensor</em>) – Center of lens position on y-axis (arcsec).</p></li>
<li><p><strong>mass</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Mass of the lens (Msol).</p></li>
<li><p><strong>scale_radius</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Scale radius of the TNFW lens (arcsec).</p></li>
<li><p><strong>tau</strong> (<em>Optional</em><em>[</em><em>Tensor</em><em>]</em>) – Truncation scale. Ratio of truncation radius to scale radius (rt/rs).</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dynamic parameter container.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The lensing potential.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-caustics.lenses.utils">
<span id="caustics-lenses-utils-module"></span><h2>caustics.lenses.utils module<a class="headerlink" href="#module-caustics.lenses.utils" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="caustics.lenses.utils.get_magnification">
<span class="sig-prename descclassname"><span class="pre">caustics.lenses.utils.</span></span><span class="sig-name descname"><span class="pre">get_magnification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raytrace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/utils.html#get_magnification"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.utils.get_magnification" title="Link to this definition"></a></dt>
<dd><p>Computes the magnification over a grid on the lensing plane. This is done by calling <cite>get_pix_magnification</cite>
for each point on the grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raytrace</strong> – A function that maps the lensing plane coordinates to the source plane coordinates.</p></li>
<li><p><strong>x</strong> (<em>Tensor</em>) – The x-coordinates on the lensing plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – The y-coordinates on the lensing plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – The redshift of the source.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor representing the magnification at each point on the grid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="caustics.lenses.utils.get_pix_jacobian">
<span class="sig-prename descclassname"><span class="pre">caustics.lenses.utils.</span></span><span class="sig-name descname"><span class="pre">get_pix_jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raytrace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/caustics/lenses/utils.html#get_pix_jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.utils.get_pix_jacobian" title="Link to this definition"></a></dt>
<dd><p>Computes the Jacobian matrix of the partial derivatives of the
image position with respect to the source position
(<span class="math notranslate nohighlight">\(\partial eta / \partial    heta\)</span>).  This is done at a
single point on the lensing plane.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raytrace</strong> – A function that maps the lensing plane coordinates to the source plane coordinates.</p></li>
<li><p><strong>x</strong> (<em>Tensor</em>) – The x-coordinate on the lensing plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – The y-coordinate on the lensing plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – The redshift of the source.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The Jacobian matrix of the image position with respect to the source position at the given point.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="caustics.lenses.utils.get_pix_magnification">
<span class="sig-prename descclassname"><span class="pre">caustics.lenses.utils.</span></span><span class="sig-name descname"><span class="pre">get_pix_magnification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raytrace</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_s</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/caustics/lenses/utils.html#get_pix_magnification"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#caustics.lenses.utils.get_pix_magnification" title="Link to this definition"></a></dt>
<dd><p>Computes the magnification at a single point on the lensing plane. The magnification is derived from the determinant
of the Jacobian matrix of the image position with respect to the source position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raytrace</strong> – A function that maps the lensing plane coordinates to the source plane coordinates.</p></li>
<li><p><strong>x</strong> (<em>Tensor</em>) – The x-coordinate on the lensing plane.</p></li>
<li><p><strong>y</strong> (<em>Tensor</em>) – The y-coordinate on the lensing plane.</p></li>
<li><p><strong>z_s</strong> (<em>Tensor</em>) – The redshift of the source.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The magnification at the given point on the lensing plane.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-caustics.lenses">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-caustics.lenses" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="caustics.data.html" class="btn btn-neutral float-left" title="caustics.data package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="caustics.light.html" class="btn btn-neutral float-right" title="caustics.light package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Ciela Institute.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>